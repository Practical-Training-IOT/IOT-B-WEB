/*! 
 Build based on gin-vue-admin 
 Time : 1746843967000 */
import{_ as e,Q as a,u as s,a as t,k as l,V as n,a0 as u,H as r,as as o,g as i,c as v,o as m,f as c,I as d,w as p,F as y,D as g,i as f,b as h,n as b,h as S,t as I,v as q,aq as x,ax as w,J as k,a6 as O,L as N}from"./087AC4D233B64EB0index.CO5TVuii.js";const J={class:"gva-tabs"},C=["tab"],E=e(Object.assign({name:"HistoryComponent"},{__name:"index",setup(e){const E=a(),V=s(),A=e=>e.name+JSON.stringify(e.query)+JSON.stringify(e.params),P=t([]),_=t(""),j=t(!1),L=l(),T=t(0),R=t(0),B=t(!1),D=t(!1),H=t(""),Q=n((()=>L.userInfo.authority.defaultRouter)),U=()=>{P.value=[{name:Q.value,meta:{title:"首页"},query:{},params:{}}],V.push({name:Q.value}),j.value=!1,sessionStorage.setItem("historys",JSON.stringify(P.value))},F=()=>{let e;const a=P.value.findIndex((a=>(A(a)===H.value&&(e=a),A(a)===H.value))),s=P.value.findIndex((e=>A(e)===_.value));P.value.splice(0,a),a>s&&V.push(e),sessionStorage.setItem("historys",JSON.stringify(P.value))},K=()=>{let e;const a=P.value.findIndex((a=>(A(a)===H.value&&(e=a),A(a)===H.value))),s=P.value.findIndex((e=>A(e)===_.value));P.value.splice(a+1,P.value.length),a<s&&V.push(e),sessionStorage.setItem("historys",JSON.stringify(P.value))},M=()=>{let e;P.value=P.value.filter((a=>(A(a)===H.value&&(e=a),A(a)===H.value))),V.push(e),sessionStorage.setItem("historys",JSON.stringify(P.value))},X=e=>{if(!P.value.some((a=>((e,a)=>{if(e.name!==a.name)return!1;if(Object.keys(e.query).length!==Object.keys(a.query).length||Object.keys(e.params).length!==Object.keys(a.params).length)return!1;for(const s in e.query)if(e.query[s]!==a.query[s])return!1;for(const s in e.params)if(e.params[s]!==a.params[s])return!1;return!0})(a,e)))){const a={};a.name=e.name,a.meta={...e.meta},delete a.meta.matched,a.query=e.query,a.params=e.params,P.value.push(a)}window.sessionStorage.setItem("activeValue",A(e))},Y=t({}),$=e=>{var a;const s=null==(a=null==e?void 0:e.props)?void 0:a.name;if(!s)return;const t=Y.value[s];V.push({name:t.name,query:t.query,params:t.params})},z=e=>{const a=P.value.findIndex((a=>A(a)===e));A(E)===e&&(1===P.value.length?V.push({name:Q.value}):a<P.value.length-1?V.push({name:P.value[a+1].name,query:P.value[a+1].query,params:P.value[a+1].params}):V.push({name:P.value[a-1].name,query:P.value[a-1].query,params:P.value[a-1].params})),P.value.splice(a,1)};u((()=>j.value),(()=>{j.value?document.body.addEventListener("click",(()=>{j.value=!1})):document.body.removeEventListener("click",(()=>{j.value=!1}))})),u((()=>E),(e=>{"Login"!==e.name&&"Reload"!==e.name&&(P.value=P.value.filter((e=>!e.meta.closeTab)),X(e),sessionStorage.setItem("historys",JSON.stringify(P.value)),_.value=window.sessionStorage.getItem("activeValue"))}),{deep:!0}),u((()=>P.value),(()=>{sessionStorage.setItem("historys",JSON.stringify(P.value)),Y.value={},P.value.forEach((e=>{Y.value[A(e)]=e})),o.emit("setKeepAlive",P.value)}),{deep:!0});(()=>{o.on("closeThisPage",(()=>{z(A(E))})),o.on("closeAllPage",(()=>{U()})),o.on("mobile",(e=>{D.value=e})),o.on("collapse",(e=>{B.value=e})),o.on("setQuery",(e=>{const a=P.value.findIndex((e=>A(e)===_.value));P.value[a].query=e,_.value=A(P.value[a]);const s=window.location.href.split("?")[0],t=new URLSearchParams(e).toString();window.history.replaceState({},"","".concat(s,"?").concat(t)),sessionStorage.setItem("historys",JSON.stringify(P.value))})),o.on("switchTab",(async e=>{const a=P.value.findIndex((a=>a.name===e.name));if(!(a<0)){for(const a in e.query)e.query[a]=String(e.query[a]);for(const a in e.params)e.params[a]=String(e.params[a]);P.value[a].query=e.query||{},P.value[a].params=e.params||{},await N(),V.push(P.value[a])}}));const e=[{name:Q.value,meta:{title:"首页"},query:{},params:{}}];X(E),P.value=JSON.parse(sessionStorage.getItem("historys"))||e,window.sessionStorage.getItem("activeValue")?_.value=window.sessionStorage.getItem("activeValue"):_.value=A(E),"true"===window.sessionStorage.getItem("needCloseAll")&&(U(),window.sessionStorage.removeItem("needCloseAll"))})(),r((()=>{o.off("collapse"),o.off("mobile")}));return(e,a)=>{const s=i("el-tab-pane"),t=i("el-tabs");return m(),v("div",J,[c(t,{modelValue:_.value,"onUpdate:modelValue":a[0]||(a[0]=e=>_.value=e),closable:!(1===P.value.length&&e.$route.name===Q.value),type:"card",class:"bg-white text-slate-700 dark:text-slate-500 dark:bg-slate-900",onContextmenu:a[1]||(a[1]=w((e=>(e=>{if(1===P.value.length&&E.name===Q.value)return!1;let a="";a="SPAN"===e.srcElement.nodeName?e.srcElement.offsetParent.id:e.srcElement.id,a&&(j.value=!0,T.value=e.clientX,R.value=e.clientY+10,H.value=a.substring(4))})(e)),["prevent"])),onTabClick:$,onTabRemove:z,onMouseup:a[2]||(a[2]=w((e=>(e=>{if(1===P.value.length&&E.name===Q.value)return!1;let a="";a="SPAN"===e.srcElement.nodeName?e.srcElement.offsetParent.id:e.srcElement.id,a&&z(a.substring(4))})(e)),["middle","prevent"]))},{default:p((()=>[(m(!0),v(y,null,g(P.value,(e=>(m(),f(s,{key:A(e),label:e.meta.title,name:A(e),tab:e,class:"border-none"},{label:p((()=>[h("span",{tab:e,class:b(_.value===A(e)?"text-active":"text-gray-600 dark:text-slate-400 ")},[h("i",{class:b(_.value===A(e)?"text-active":"text-gray-600 dark:text-slate-400")},null,2),S(" "+I(q(x)(e.meta.title,e)),1)],10,C)])),_:2},1032,["label","name","tab"])))),128))])),_:1},8,["modelValue","closable"]),d(h("ul",{style:O({left:T.value+"px",top:R.value+"px"}),class:"contextmenu"},[h("li",{onClick:U},"关闭所有"),h("li",{onClick:F},"关闭左侧"),h("li",{onClick:K},"关闭右侧"),h("li",{onClick:M},"关闭其他")],4),[[k,j.value]])])}}}),[["__scopeId","data-v-4e7543cd"]]);export{E as default};
