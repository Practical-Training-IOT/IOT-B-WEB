/*! 
 Build based on gin-vue-admin 
 Time : 1746843967000 */
import{_ as e,a,a0 as t,g as l,c as o,o as s,b as u,f as n,w as r,h as d,d as c,t as i,ax as m,a6 as p,aK as y,aL as f,E as h,L as v,aM as w}from"./087AC4D233B64EB0index.CO5TVuii.js";import{u as k}from"./087AC4D233B64EB0authority.Gcekx5hE.js";import{g as I,s as g}from"./087AC4D233B64EB0authorityBtn.C0QvJlsH.js";const b={class:"sticky top-0.5 z-10"},_={class:"tree-content clear-both"},C={class:"custom-tree-node"},D={key:0},R={key:1},B={class:"dialog-footer"},x=e(Object.assign({name:"Menus"},{__name:"menus",props:{row:{default:function(){return{}},type:Object}},emits:["changeRow"],setup(e,{expose:x,emit:E}){const A=e,V=E,j=a(""),N=a([]),O=a([]),L=a(!1),M=a({children:"children",label:function(e){return e.meta.title},disabled:function(e){return A.row.defaultRouter===e.name}});(async()=>{const e=await y();N.value=e.data.menus;const a=(await f({authorityId:A.row.authorityId})).data.menus,t=[];a.forEach((e=>{a.some((a=>a.parentId===e.menuId))||t.push(Number(e.menuId))})),O.value=t})();const S=()=>{L.value=!0},T=a(null),U=async()=>{const e=T.value.getCheckedNodes(!1,!0);0===(await w({menus:e,authorityId:A.row.authorityId})).code&&h({type:"success",message:"菜单设置成功!"})};x({enterAndNext:()=>{U()},needConfirm:L});const z=a(!1),K=a([]),q=a([]),F=a();let G="";const H=e=>{q.value=e},J=e=>{z.value=!0,K.value=e.menuBtn},P=()=>{z.value=!1},Q=async()=>{const e=q.value.map((e=>e.ID));0===(await g({menuID:G,selected:e,authorityId:A.row.authorityId})).code&&(h({type:"success",message:"设置成功"}),z.value=!1)},W=(e,a)=>!e||-1!==a.meta.title.indexOf(e);return t(j,(e=>{T.value.filter(e)})),(a,t)=>{const y=l("el-input"),f=l("el-button"),w=l("el-tree"),g=l("el-scrollbar"),x=l("el-table-column"),E=l("el-table"),L=l("el-dialog");return s(),o("div",null,[u("div",b,[n(y,{modelValue:j.value,"onUpdate:modelValue":t[0]||(t[0]=e=>j.value=e),class:"w-3/5",placeholder:"筛选"},null,8,["modelValue"]),n(f,{class:"float-right",type:"primary",onClick:U},{default:r((()=>t[2]||(t[2]=[d("确 定")]))),_:1})]),u("div",_,[n(g,null,{default:r((()=>[n(w,{ref_key:"menuTree",ref:T,data:N.value,"default-checked-keys":O.value,props:M.value,"default-expand-all":"","highlight-current":"","node-key":"ID","show-checkbox":"","filter-node-method":W,onCheck:S},{default:r((({node:a,data:l})=>[u("span",C,[u("span",null,i(a.label),1),a.checked?(s(),o("span",D,[n(f,{type:"primary",link:"",style:p({color:e.row.defaultRouter===l.name?"#E6A23C":"#85ce61"}),onClick:m((()=>(async e=>{const a=await k({authorityId:A.row.authorityId,AuthorityName:A.row.authorityName,parentId:A.row.parentId,defaultRouter:e.name});0===a.code&&(h({type:"success",message:"设置成功"}),V("changeRow","defaultRouter",a.data.authority.defaultRouter))})(l)),["stop"])},{default:r((()=>[d(i(e.row.defaultRouter===l.name?"首页":"设为首页"),1)])),_:2},1032,["style","onClick"])])):c("",!0),l.menuBtn.length?(s(),o("span",R,[n(f,{type:"primary",link:"",onClick:m((()=>(async e=>{G=e.ID;const a=await I({menuID:G,authorityId:A.row.authorityId});0===a.code&&(J(e),await v(),a.data.selected&&a.data.selected.forEach((e=>{K.value.some((a=>{a.ID===e&&F.value.toggleRowSelection(a,!0)}))})))})(l)),["stop"])},{default:r((()=>t[3]||(t[3]=[d(" 分配按钮 ")]))),_:2},1032,["onClick"])])):c("",!0)])])),_:1},8,["data","default-checked-keys","props"])])),_:1})]),n(L,{modelValue:z.value,"onUpdate:modelValue":t[1]||(t[1]=e=>z.value=e),title:"分配按钮","destroy-on-close":""},{footer:r((()=>[u("div",B,[n(f,{onClick:P},{default:r((()=>t[4]||(t[4]=[d("取 消")]))),_:1}),n(f,{type:"primary",onClick:Q},{default:r((()=>t[5]||(t[5]=[d("确 定")]))),_:1})])])),default:r((()=>[n(E,{ref_key:"btnTableRef",ref:F,data:K.value,"row-key":"ID",onSelectionChange:H},{default:r((()=>[n(x,{type:"selection",width:"55"}),n(x,{label:"按钮名称",prop:"name"}),n(x,{label:"按钮备注",prop:"desc"})])),_:1},8,["data"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-5ea6c383"]]);export{x as default};
